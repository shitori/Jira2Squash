<%- include('./commonHeader.ejs'); %>

    <head>
        <title>
            Game Of Life
        </title>
    </head>
    <script type="text/javascript" src="/javascripts/game/v1/game.js"></script>
    <script type="text/javascript" src="/javascripts/game/v2/game.js"></script>

    <script>


        const params = new URLSearchParams(window.location.search)
        const max = params.get('max')
        const life = params.get('life')
        var cpt = 0
        const speed = 100
        var interval
        const oldCell = 50



        function applyCpt(cpt) {
            document.getElementById("compteur").textContent = cpt
        }

        document.addEventListener("DOMContentLoaded", function (event) {

        });

        function start() {
            interval = setInterval(() => {
                applyMouvementV2(getCurrentStatutV2());
                applyCpt(cpt++);
            }, speed)
        }

        function stop() {
            clearInterval(interval)
        }

        function oneStep() {
            applyMouvementV2(getCurrentStatutV2());
            applyCpt(cpt++);
        }

    </script>

    <body class="container-fluid bg-light">
        <div class="mt-2 p-5 ">
            <h1>Cycle de vie : <span id="compteur"></span></h1>
            <table class="mb-5">
                <tr>
                    <th class="border bg-primary p-1"></th>
                    <th class="border bg-secondary p-1"></th>
                    <th class="border bg-success p-1"></th>
                    <th class="border bg-danger p-1"></th>
                    <th class="border bg-warning p-1"></th>
                    <th class="border bg-info p-1"></th>
                    <th class="border bg-dark p-1"></th>
                    <th class="border bg-light p-1"></th>
                </tr>
                <tr>
                    <td>Eau</td>
                    <td>Montagne</td>
                    <td>Forêt</td>
                    <td>Calamité</td>
                    <td>Sable</td>
                    <td>Glace</td>
                    <td>Civilisation</td>
                    <td>Vide</td>
                </tr>
            </table>


            <table>

                <% for(var i=0; i<max; i++) {%>
                    <tr>
                        <% for(var j=0; j<max*2; j++) {%>



                            <% switch (array[i][j]) { case 1 : %>

                                <td class=" bg-primary p-1 " id="<%= max * 2 * i + j %>" data-life="0"></td>
                                <% break; case 2 : %>
                                    <td class=" bg-secondary p-1 " id="<%= max * 2 * i + j %>" data-life="0"></td>
                                    <% break; case 3 : %>
                                        <td class=" bg-success p-1 " id="<%= max * 2 * i + j %>" data-life="0"></td>
                                        <% break; case 4 : %>
                                            <td class=" bg-danger p-1 " id="<%= max * 2 * i + j %>" data-life="0">
                                            </td>
                                            <% break; case 5 : %>
                                                <td class=" bg-warning p-1 " id="<%= max * 2 * i + j %>" data-life="0">
                                                </td>
                                                <% break; case 6 : %>
                                                    <td class=" bg-info p-1 " id="<%= max * 2 * i + j %>" data-life="0">
                                                    </td>
                                                    <% break; case 7 : %>
                                                        <td class=" bg-dark p-1 " id="<%= max * 2 * i + j %>"
                                                            data-life="0">
                                                        </td>
                                                        <% break; case 0 : %>
                                                            <td class=" bg-light p-1 " id="<%= max * 2 * i + j %>"
                                                                data-life="0"></td>
                                                            <% break; default : %>


                                                                <% break; } %>
                                                                    <% } %>
                    </tr>
                    <% } %>






            </table>

            <div class="row">
                <button type="button" onclick="stop()" class="mt-2 col btn btn-outline-danger btn-lg">Stop</button>
                <button type="button" onclick="oneStep()" class="mt-2 col btn btn-outline-primary btn-lg">Step</button>
                <button type="button" onclick="start()" class="mt-2 col btn btn-outline-success btn-lg">Start</button>
            </div>


        </div>
    </body>